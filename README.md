# 大学生消费管理系统

一个基于Python Tkinter与Excel的大学生消费管理系统，帮助大学生有效管理生活费开支。

## 系统功能

1. **预算管理**：设置月度预算并实时跟踪支出情况
2. **消费记录**：按类别记录日常消费，支持添加、查询和展示
3. **分类统计**：自动统计各类别消费占比，生成直观的饼图
4. **预算提醒**：当消费接近预算阈值时自动提醒
5. **月度报告**：生成PDF格式的详细消费分析报告
6. **数据备份与恢复**：支持数据备份和恢复，防止数据丢失
7. **自定义提醒阈值**：可根据个人需求设置预算提醒阈值

## 技术栈

- **前端界面**：Python Tkinter
- **数据存储**：Excel (openpyxl)
- **数据可视化**：Matplotlib
- **报告生成**：FPDF

## 安装与使用

### 方法一：使用启动脚本（推荐）

1. 确保已安装Python 3.7或更高版本
2. 双击运行`start.bat`文件
3. 脚本会自动检查虚拟环境和依赖，并启动程序

### 方法二：手动安装

1. 确保已安装Python 3.7或更高版本
2. 创建虚拟环境（可选但推荐）：
   ```
   python -m venv .venv
   ```
3. 激活虚拟环境：
   - Windows: `.venv\Scripts\activate`
   - macOS/Linux: `source .venv/bin/activate`
4. 安装依赖：
   ```
   pip install -r requirements.txt
   ```
5. 运行程序：
   ```
   python main.py
   ```

## 使用说明

### 1. 设置月度预算

1. 在"月度预算设置"区域选择月份
2. 输入预算金额
3. 点击"设置预算"按钮

### 2. 添加消费记录

1. 点击"添加消费"按钮
2. 在弹出的窗口中输入消费金额、选择消费类别、填写说明
3. 点击"确定"按钮保存

### 3. 查询消费记录

1. 在"消费记录查询"区域选择查询类型（全部、日期、类别、说明）
2. 输入查询关键词
3. 点击"搜索"按钮

### 4. 生成月度报告

1. 点击"生成月度报告"按钮
2. 系统会自动生成当前月份的PDF格式消费报告

### 5. 数据备份与恢复

1. 点击"创建备份"按钮可创建当前数据的备份
2. 点击"恢复备份"按钮可选择之前的备份文件进行恢复

### 6. 预算提醒设置

1. 在"预算提醒设置"区域输入提醒阈值（百分比）
2. 点击"保存设置"按钮

## 注意事项

1. 数据默认存储在`expenses.xlsx`文件中，请妥善保管
2. 备份文件默认保存在`expenses_backup`文件夹中
3. 月度报告默认保存在当前目录下，文件名为"X月消费报告.pdf"
4. 如需修改预算提醒阈值，修改后需要重启程序才能生效

## 常见问题

### Q: 程序启动时提示缺少依赖库

A: 请运行`pip install -r requirements.txt`安装所有必要的依赖库

### Q: 生成的PDF报告中中文显示乱码

A: 确保系统中安装了中文字体，如宋体、黑体等

### Q: 如何修改已有的消费记录

A: 目前版本暂不支持直接修改消费记录，您可以手动编辑`expenses.xlsx`文件进行修改

### Q: 备份文件保存在哪里

A: 备份文件保存在程序目录下的`expenses_backup`文件夹中，文件名包含时间戳

## 系统要求

- Python 3.7或更高版本
- Windows、macOS或Linux操作系统
- 至少50MB可用存储空间

## 开发团队

大学生消费管理系统开发组

## 更新日志

**v1.0.0**
- 初始版本发布
- 实现预算管理、消费记录、分类统计等核心功能
- 支持PDF报告生成和数据备份恢复